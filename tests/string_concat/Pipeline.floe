-- Test string concatenation with ++

schema Input {
    first_name: String,
    last_name: String,
    title: String,
}

schema Output {
    full_name: String,
    greeting: String,
}

let transform : Input -> Output = map {
    full_name: .first_name ++ " " ++ .last_name,
    greeting: "Hello, " ++ .title ++ " " ++ .last_name,
}

main = do
    data <- read "input.parquet" as Input
    result <- data |> transform
    sink "output.parquet" result
