-- Test cast expressions

schema Input {
    intValue: Int64,
    floatValue: Float64,
    stringValue: String,
}

schema Output {
    asFloat: Float64,
    asInt: Int64,
    asString: String,
}

let convertTypes : Input -> Output =
    map {
        asFloat: .intValue as Float64,
        asInt: .floatValue as Int64,
        asString: .intValue as String
    }

main = do
    data <- read "input.parquet" as Input
    result <- data |> convertTypes
    sink "output.parquet" result
