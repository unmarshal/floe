-- Test that non-Maybe columns reject nulls at runtime

schema Input {
    name: String,
    age: Int64,
}

schema Output {
    name: String,
    age: Int64,
}

let transform : Input -> Output = select [name, age]

main = do
    data <- read "input.parquet" as Input
    result <- data |> transform
    sink "output.parquet" result
