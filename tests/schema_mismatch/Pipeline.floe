-- Test runtime schema validation catches mismatches

schema Expected {
    id: String,
    amount: Decimal(10, 2),
}

schema Output {
    id: String,
    amount: Decimal(10, 2),
}

let passthrough : Expected -> Output =
    map {
        id: .id,
        amount: .amount
    }

main = do
    data <- read "input.parquet" as Expected
    result <- data |> passthrough
    sink "output.parquet" result
