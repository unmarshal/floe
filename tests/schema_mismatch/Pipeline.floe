-- Test runtime schema validation catches mismatches

schema Expected {
    id: String,
    amount: Decimal(10, 2),
}

schema Output {
    id: String,
    amount: Decimal(10, 2),
}

let passthrough : Expected -> Output =
    map {
        id: .id,
        amount: .amount
    }

let result = read "input.parquet" as Expected |> passthrough

sink "output.parquet" result
