-- @error "type mismatch"
schema User {
    id: Int64,
    name: String,
}

schema Order {
    order_id: String,
    user_id: String,
}

schema EnrichedOrder {
    order_id: String,
    name: String,
}

let users = read "users.parquet" as User

fn enrich :: Order -> EnrichedOrder
fn enrich =
    join users on .user_id == .id
    >> map { order_id: .order_id, name: .name }
