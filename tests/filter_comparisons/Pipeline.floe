schema Product {
    name: String,
    price: Int,
    category: String,
    in_stock: Bool,
}

schema AffordableProduct {
    name: String,
    price: Int,
    category: String,
    in_stock: Bool,
}

let filterAffordable : Product -> AffordableProduct =
    filter .price < 100
    >> filter .in_stock

main =
    read "products.parquet" as Product
    |> filterAffordable
    sink "output.parquet"
