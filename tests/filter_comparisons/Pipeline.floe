schema Product {
    name: String,
    price: Int64,
    category: String,
    in_stock: Bool,
}

schema AffordableProduct {
    name: String,
    price: Int64,
    category: String,
    in_stock: Bool,
}

let filterAffordable : Product -> AffordableProduct =
    filter .price < 100
    >> filter .in_stock

let result = read "products.parquet" as Product |> filterAffordable

sink "output.parquet" result
