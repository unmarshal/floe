-- Test runtime schema validation catches missing columns

schema Expected {
    id: String,
    name: String,
    email: String,
}

schema Output {
    id: String,
    name: String,
    email: String,
}

let passthrough : Expected -> Output =
    map {
        id: .id,
        name: .name,
        email: .email
    }

main = do
    data <- read "input.parquet" as Expected
    result <- data |> passthrough
    sink "output.parquet" result
