-- Test fillNull type mismatch: trying to fill Maybe Int64 with a string

schema Input {
    id: Int64,
    score: Maybe Int64,
}

schema Output {
    id: Int64,
    score: Int64,
}

-- This should fail: filling an Int64 column with a string literal
let fillScore : Maybe Int64 -> Int64 = fillNull "zero"

let transform : Input -> Output =
    transform [score] fillScore

main = do
    data <- read "input.parquet" as Input
    result <- data |> transform
    sink "output.parquet" result
