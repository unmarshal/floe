-- Test arithmetic expressions

schema Product {
    name: String,
    price: Int64,
    quantity: Int64,
    discount: Int64,
}

schema OrderSummary {
    name: String,
    total: Int64,
    discounted_price: Int64,
    profit_margin: Int64,
}

let calculateTotals : Product -> OrderSummary =
    map {
        name: .name,
        total: .price * .quantity,
        discounted_price: .price - .discount,
        profit_margin: .price / 10 + 5
    }

main = do
    data <- read "input.parquet" as Product
    result <- data |> calculateTotals
    sink "output.parquet" result
