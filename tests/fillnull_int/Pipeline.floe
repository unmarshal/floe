-- Test fillNull with Maybe Int64 -> Int64

schema Input {
    id: Int64,
    score: Maybe Int64,
}

schema Output {
    id: Int64,
    score: Int64,
}

let fillScore : Maybe Int64 -> Int64 = fillNull 0

let transform : Input -> Output =
    transform [score] fillScore

let result = read "input.parquet" as Input |> transform

sink "output.parquet" result
