-- Test fillNull with Maybe Float64 -> Float64

schema Input {
    id: Int64,
    price: Maybe Float64,
}

schema Output {
    id: Int64,
    price: Float64,
}

let fillPrice : Maybe Float64 -> Float64 = fillNull 0.0

let transform : Input -> Output =
    transform [price] fillPrice

let result = read "input.parquet" as Input |> transform

sink "output.parquet" result
