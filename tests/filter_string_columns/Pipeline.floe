schema Employee {
    name: String,
    department: String,
    assigned_team: String,
}

schema MatchedEmployee {
    name: String,
    department: String,
    assigned_team: String,
}

let filterMatched : Employee -> MatchedEmployee =
    filter .department == .assigned_team

main = do
    data <- read "employees.parquet" as Employee
    result <- data |> filterMatched
    sink "output.parquet" result
