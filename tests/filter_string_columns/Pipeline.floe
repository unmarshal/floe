schema Employee {
    name: String,
    department: String,
    assigned_team: String,
}

schema MatchedEmployee {
    name: String,
    department: String,
    assigned_team: String,
}

let filterMatched : Employee -> MatchedEmployee =
    filter .department == .assigned_team

main =
    read "employees.parquet" as Employee
    |> filterMatched
    sink "output.parquet"
