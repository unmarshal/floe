-- Test if-then-else expressions

schema Input {
    status: String,
    value: Int64,
    is_premium: Bool,
}

schema Output {
    status: String,
    category: String,
    tier: String,
}

-- Test if-else with comparison in condition
let categorize : Input -> Output =
    map {
        status: .status,
        category: if .value > 100 then "high" else "low",
        tier: if .is_premium then "premium" else "standard"
    }

main = do
    data <- read "input.parquet" as Input
    result <- data |> categorize
    sink "output.parquet" result
